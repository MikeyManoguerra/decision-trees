a25e5f18b892069828eb181d45853f61
"use strict";

var _interopRequireDefault = require("/home/flightlessbird/Thinkful/projects/CYOA/client-5NodeBodies/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireDefault(require("react"));

var _reactRedux = require("react-redux");

var _reactD3Graph = require("react-d3-graph");

var _nodes = require("../actions/nodes");

var _createAdventure = require("../actions/createAdventure");

var _jsxFileName = "/home/flightlessbird/Thinkful/projects/CYOA/client-5NodeBodies/src/components/graph-container.js";

class GraphContainer extends _react.default.Component {
  constructor(props) {
    super(props);

    this.handleResize = () => {
      let windowHeight = window.innerHeight;
      let windowWidth = window.innerWidth;
      this.setState({
        windowHeight,
        windowWidth
      });
    };

    this.state = {
      windowHeight: window.innerHeight,
      windowWidth: window.innerWidth
    };
  }

  onClickNode(nodeId) {
    let nodeArr = this.props.nodez.filter(node => node.id === nodeId);
    this.props.dispatch((0, _nodes.setCurrentNode)(nodeArr[0]));
    console.log("reRender is: ", this.props.reRender); // this.props.dispatch(reRenderGraph())
  }

  getFullNode(nodeId) {
    //get full node is outside of the class due to *this* being binded to the graph
    const nodeArr = this.props.nodez.filter(node => node.id === nodeId);
    return nodeArr[0];
  }

  populateGraph() {
    let chartData = {
      nodes: [],
      links: []
    };

    for (let i = 0; i < this.props.nodez.length; i++) {
      if (i === 0) {
        chartData.nodes.push({
          id: this.props.nodez[i].id,
          title: this.props.nodez[i].title ? this.props.nodez[i].title : this.props.nodez[i].question,
          color: '#9D601B',
          symbolType: "triangle"
        });

        if (this.props.nodez[i].pointerA) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerA
          });
        }

        if (this.props.nodez[i].pointerB) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerB
          });
        }

        if (this.props.nodez[i].pointerC) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerC
          });
        }

        if (this.props.nodez[i].pointerD) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerD
          });
        }
      } else {
        chartData.nodes.push({
          id: this.props.nodez[i].id,
          title: this.props.nodez[i].title ? this.props.nodez[i].title : this.props.nodez[i].question,
          color: this.props.nodez[i].ending ? '#51646b' : '#b4cedd',
          symbolType: this.props.nodez[i].ending ? "square" : "circle"
        });

        if (this.props.nodez[i].pointerA) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerA
          });
        }

        if (this.props.nodez[i].pointerB) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerB
          });
        }

        if (this.props.nodez[i].pointerC) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerC
          });
        }

        if (this.props.nodez[i].pointerD) {
          chartData.links.push({
            source: this.props.nodez[i].id,
            target: this.props.nodez[i].pointerD
          });
        }
      }
    }

    chartData.nodes[0].x = this.state.windowWidth / 2;
    chartData.nodes[0].y = this.state.windowHeight / 2;
    return chartData;
  }

  resizeGraph() {
    let cyStyle = {
      margin: 'auto',
      border: '1px solid lightgreen'
    };
    cyStyle.maxHeight = Math.max(this.state.windowHeight * .5, 500);
    cyStyle.maxWidth = Math.max(this.state.windowWidth * .8, 300);
    return cyStyle;
  } //if you change this from an arrow function, this.setState fails


  componentDidMount() {
    window.addEventListener("resize", this.handleResize);
  }

  componentWillMount() {
    this.populateGraph();
    this.resizeGraph();
  }

  componentWillUnmount() {
    window.removeEventListener("resize", this.handleResize);
  }

  render() {
    const myConfig = {
      nodeHighlightBehavior: true,
      directed: true,
      automaticRearrangeAfterDropNode: true,
      d3: {
        gravity: -300,
        linkLength: 120,
        forceManyBody: function strength() {
          return -1000;
        }
      },
      minZoom: .5,
      maxZoom: 1.5,
      height: Math.max(this.state.windowHeight * .5, 500),
      width: Math.max(this.state.windowWidth * .8, 300),
      //There are height and widths available here, but they're for the graph itself, not the container of the graph
      node: {
        fontSize: 18,
        color: 'lightgreen',
        size: 800,
        highlightStrokeColor: 'blue',
        labelProperty: 'title',
        highlightFontSize: 'same'
      },
      link: {
        highlightColor: 'lightblue',
        strokeWidth: 4
      }
    };

    if (!this.props.nodez) {
      return _react.default.createElement("div", {
        __source: {
          fileName: _jsxFileName,
          lineNumber: 134
        },
        __self: this
      }, "Loading....");
    } else {
      if (this.props.reRender) {
        return _react.default.createElement("div", {
          style: this.resizeGraph(),
          __source: {
            fileName: _jsxFileName,
            lineNumber: 138
          },
          __self: this
        }, " ", _react.default.createElement(_reactD3Graph.Graph, {
          props: this.props,
          id: "graph-id" // id is mandatory, if no id is defined rd3g will throw an error
          ,
          data: this.populateGraph(),
          config: myConfig,
          onClickNode: this.onClickNode // onRightClickNode={onRightClickNode}
          // onClickGraph={onClickGraph}
          // onClickLink={onClickLink}
          // onRightClickLink={onRightClickLink}
          // onMouseOverNode={onMouseOverNode}
          // onMouseOutNode={onMouseOutNode}
          // onMouseOverLink={onMouseOverLink}
          // onMouseOutLink={onMouseOutLink}
          ,
          __source: {
            fileName: _jsxFileName,
            lineNumber: 139
          },
          __self: this
        }));
      } else {
        return _react.default.createElement("div", {
          style: this.resizeGraph(),
          __source: {
            fileName: _jsxFileName,
            lineNumber: 158
          },
          __self: this
        }, _react.default.createElement(_reactD3Graph.Graph, {
          props: this.props,
          id: "graph-id" // id is mandatory, if no id is defined rd3g will throw an error
          ,
          data: this.populateGraph(),
          config: myConfig,
          onClickNode: this.onClickNode // onRightClickNode={onRightClickNode}
          // onClickGraph={onClickGraph}
          // onClickLink={onClickLink}
          // onRightClickLink={onRightClickLink}
          // onMouseOverNode={onMouseOverNode}
          // onMouseOutNode={onMouseOutNode}
          // onMouseOverLink={onMouseOverLink}
          // onMouseOutLink={onMouseOutLink}
          ,
          __source: {
            fileName: _jsxFileName,
            lineNumber: 159
          },
          __self: this
        }));
      }
    }
  }

}

const mapStateToProps = state => ({
  nodez: state.adventure.currentAdventure.nodes,
  showUpdate: state.node.showUpdate,
  currentNode: state.node.currentNode,
  reRender: state.adventure.reRender
}); // connect(mapStateToProps)(Graph)


var _default = (0, _reactRedux.connect)(mapStateToProps)(GraphContainer);

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdyYXBoLWNvbnRhaW5lci5qcyJdLCJuYW1lcyI6WyJHcmFwaENvbnRhaW5lciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImhhbmRsZVJlc2l6ZSIsIndpbmRvd0hlaWdodCIsIndpbmRvdyIsImlubmVySGVpZ2h0Iiwid2luZG93V2lkdGgiLCJpbm5lcldpZHRoIiwic2V0U3RhdGUiLCJzdGF0ZSIsIm9uQ2xpY2tOb2RlIiwibm9kZUlkIiwibm9kZUFyciIsIm5vZGV6IiwiZmlsdGVyIiwibm9kZSIsImlkIiwiZGlzcGF0Y2giLCJjb25zb2xlIiwibG9nIiwicmVSZW5kZXIiLCJnZXRGdWxsTm9kZSIsInBvcHVsYXRlR3JhcGgiLCJjaGFydERhdGEiLCJub2RlcyIsImxpbmtzIiwiaSIsImxlbmd0aCIsInB1c2giLCJ0aXRsZSIsInF1ZXN0aW9uIiwiY29sb3IiLCJzeW1ib2xUeXBlIiwicG9pbnRlckEiLCJzb3VyY2UiLCJ0YXJnZXQiLCJwb2ludGVyQiIsInBvaW50ZXJDIiwicG9pbnRlckQiLCJlbmRpbmciLCJ4IiwieSIsInJlc2l6ZUdyYXBoIiwiY3lTdHlsZSIsIm1hcmdpbiIsImJvcmRlciIsIm1heEhlaWdodCIsIk1hdGgiLCJtYXgiLCJtYXhXaWR0aCIsImNvbXBvbmVudERpZE1vdW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNvbXBvbmVudFdpbGxNb3VudCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInJlbmRlciIsIm15Q29uZmlnIiwibm9kZUhpZ2hsaWdodEJlaGF2aW9yIiwiZGlyZWN0ZWQiLCJhdXRvbWF0aWNSZWFycmFuZ2VBZnRlckRyb3BOb2RlIiwiZDMiLCJncmF2aXR5IiwibGlua0xlbmd0aCIsImZvcmNlTWFueUJvZHkiLCJzdHJlbmd0aCIsIm1pblpvb20iLCJtYXhab29tIiwiaGVpZ2h0Iiwid2lkdGgiLCJmb250U2l6ZSIsInNpemUiLCJoaWdobGlnaHRTdHJva2VDb2xvciIsImxhYmVsUHJvcGVydHkiLCJoaWdobGlnaHRGb250U2l6ZSIsImxpbmsiLCJoaWdobGlnaHRDb2xvciIsInN0cm9rZVdpZHRoIiwibWFwU3RhdGVUb1Byb3BzIiwiYWR2ZW50dXJlIiwiY3VycmVudEFkdmVudHVyZSIsInNob3dVcGRhdGUiLCJjdXJyZW50Tm9kZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFHQSxNQUFNQSxjQUFOLFNBQTZCQyxlQUFNQyxTQUFuQyxDQUE2QztBQUN6Q0MsRUFBQUEsV0FBVyxDQUFDQyxLQUFELEVBQU87QUFDZCxVQUFNQSxLQUFOOztBQURjLFNBd0VsQkMsWUF4RWtCLEdBd0VILE1BQU07QUFDakIsVUFBSUMsWUFBWSxHQUFHQyxNQUFNLENBQUNDLFdBQTFCO0FBQ0EsVUFBSUMsV0FBVyxHQUFHRixNQUFNLENBQUNHLFVBQXpCO0FBQ0EsV0FBS0MsUUFBTCxDQUFjO0FBQ1ZMLFFBQUFBLFlBRFU7QUFFVkcsUUFBQUE7QUFGVSxPQUFkO0FBSUgsS0EvRWlCOztBQUVkLFNBQUtHLEtBQUwsR0FBYTtBQUNYTixNQUFBQSxZQUFZLEVBQUVDLE1BQU0sQ0FBQ0MsV0FEVjtBQUVYQyxNQUFBQSxXQUFXLEVBQUVGLE1BQU0sQ0FBQ0c7QUFGVCxLQUFiO0FBSUg7O0FBQ0RHLEVBQUFBLFdBQVcsQ0FBQ0MsTUFBRCxFQUFTO0FBQ2hCLFFBQUlDLE9BQU8sR0FBRyxLQUFLWCxLQUFMLENBQVdZLEtBQVgsQ0FBaUJDLE1BQWpCLENBQXlCQyxJQUFELElBQVVBLElBQUksQ0FBQ0MsRUFBTCxLQUFZTCxNQUE5QyxDQUFkO0FBQ0EsU0FBS1YsS0FBTCxDQUFXZ0IsUUFBWCxDQUFvQiwyQkFBZUwsT0FBTyxDQUFDLENBQUQsQ0FBdEIsQ0FBcEI7QUFDQU0sSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksZUFBWixFQUE2QixLQUFLbEIsS0FBTCxDQUFXbUIsUUFBeEMsRUFIZ0IsQ0FJaEI7QUFDQzs7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QVF5RCxlQUFSLEVBQXlCaEYsY0FBekIsQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBjb25uZWN0IH0gZnJvbSAncmVhY3QtcmVkdXgnO1xuaW1wb3J0IHsgR3JhcGggfSBmcm9tICdyZWFjdC1kMy1ncmFwaCc7XG5pbXBvcnQgeyBzZXRDdXJyZW50Tm9kZSB9IGZyb20gJy4uL2FjdGlvbnMvbm9kZXMnXG5pbXBvcnQgeyByZVJlbmRlckdyYXBoIH0gZnJvbSAnLi4vYWN0aW9ucy9jcmVhdGVBZHZlbnR1cmUnXG5cblxuY2xhc3MgR3JhcGhDb250YWluZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKXtcbiAgICAgICAgc3VwZXIocHJvcHMpO1xuICAgICAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgICAgIHdpbmRvd0hlaWdodDogd2luZG93LmlubmVySGVpZ2h0LFxuICAgICAgICAgIHdpbmRvd1dpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aFxuICAgICAgICB9O1xuICAgIH1cbiAgICBvbkNsaWNrTm9kZShub2RlSWQpIHtcbiAgICAgICAgbGV0IG5vZGVBcnIgPSB0aGlzLnByb3BzLm5vZGV6LmZpbHRlcigobm9kZSkgPT4gbm9kZS5pZCA9PT0gbm9kZUlkKVxuICAgICAgICB0aGlzLnByb3BzLmRpc3BhdGNoKHNldEN1cnJlbnROb2RlKG5vZGVBcnJbMF0pKVxuICAgICAgICBjb25zb2xlLmxvZyhcInJlUmVuZGVyIGlzOiBcIiwgdGhpcy5wcm9wcy5yZVJlbmRlcilcbiAgICAgICAgLy8gdGhpcy5wcm9wcy5kaXNwYXRjaChyZVJlbmRlckdyYXBoKCkpXG4gICAgICAgIH1cbiAgICAgICAgXG5cbiAgICBnZXRGdWxsTm9kZShub2RlSWQpIHsgLy9nZXQgZnVsbCBub2RlIGlzIG91dHNpZGUgb2YgdGhlIGNsYXNzIGR1ZSB0byAqdGhpcyogYmVpbmcgYmluZGVkIHRvIHRoZSBncmFwaFxuICAgICAgICBjb25zdCBub2RlQXJyID0gdGhpcy5wcm9wcy5ub2Rlei5maWx0ZXIoKG5vZGUpID0+IG5vZGUuaWQgPT09IG5vZGVJZClcbiAgICAgICAgcmV0dXJuIG5vZGVBcnJbMF1cbiAgICB9XG5cbiAgICBwb3B1bGF0ZUdyYXBoKCkge1xuICAgICAgICBsZXQgY2hhcnREYXRhID0ge1xuICAgICAgICAgIG5vZGVzOiBbXSxcbiAgICAgICAgICBsaW5rczogW11cbiAgICAgICAgfTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3BzLm5vZGV6Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNoYXJ0RGF0YS5ub2Rlcy5wdXNoKHsgaWQ6IHRoaXMucHJvcHMubm9kZXpbaV0uaWQsIHRpdGxlOiB0aGlzLnByb3BzLm5vZGV6W2ldLnRpdGxlID8gdGhpcy5wcm9wcy5ub2RleltpXS50aXRsZSA6IHRoaXMucHJvcHMubm9kZXpbaV0ucXVlc3Rpb24sIGNvbG9yOiAnI2RhODYyNCcsIHN5bWJvbFR5cGU6IFwidHJpYW5nbGVcIiB9KVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm5vZGV6W2ldLnBvaW50ZXJBKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0RGF0YS5saW5rcy5wdXNoKHsgc291cmNlOiB0aGlzLnByb3BzLm5vZGV6W2ldLmlkLCB0YXJnZXQ6IHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckEgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcnREYXRhLmxpbmtzLnB1c2goeyBzb3VyY2U6IHRoaXMucHJvcHMubm9kZXpbaV0uaWQsIHRhcmdldDogdGhpcy5wcm9wcy5ub2RleltpXS5wb2ludGVyQiB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5ub2RleltpXS5wb2ludGVyQykge1xuICAgICAgICAgICAgICAgICAgICBjaGFydERhdGEubGlua3MucHVzaCh7IHNvdXJjZTogdGhpcy5wcm9wcy5ub2RleltpXS5pZCwgdGFyZ2V0OiB0aGlzLnByb3BzLm5vZGV6W2ldLnBvaW50ZXJDIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm5vZGV6W2ldLnBvaW50ZXJEKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0RGF0YS5saW5rcy5wdXNoKHsgc291cmNlOiB0aGlzLnByb3BzLm5vZGV6W2ldLmlkLCB0YXJnZXQ6IHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckQgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNoYXJ0RGF0YS5ub2Rlcy5wdXNoKHsgaWQ6IHRoaXMucHJvcHMubm9kZXpbaV0uaWQsIHRpdGxlOiB0aGlzLnByb3BzLm5vZGV6W2ldLnRpdGxlID8gdGhpcy5wcm9wcy5ub2RleltpXS50aXRsZSA6IHRoaXMucHJvcHMubm9kZXpbaV0ucXVlc3Rpb24sIGNvbG9yOiB0aGlzLnByb3BzLm5vZGV6W2ldLmVuZGluZyA/ICcjNTE2NDZiJyA6ICcjYjRjZWRkJywgc3ltYm9sVHlwZTogdGhpcy5wcm9wcy5ub2RleltpXS5lbmRpbmcgPyBcInNxdWFyZVwiIDogXCJjaXJjbGVcIn0pXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckEpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcnREYXRhLmxpbmtzLnB1c2goeyBzb3VyY2U6IHRoaXMucHJvcHMubm9kZXpbaV0uaWQsIHRhcmdldDogdGhpcy5wcm9wcy5ub2RleltpXS5wb2ludGVyQSB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9wcy5ub2RleltpXS5wb2ludGVyQikge1xuICAgICAgICAgICAgICAgICAgICBjaGFydERhdGEubGlua3MucHVzaCh7IHNvdXJjZTogdGhpcy5wcm9wcy5ub2RleltpXS5pZCwgdGFyZ2V0OiB0aGlzLnByb3BzLm5vZGV6W2ldLnBvaW50ZXJCIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BzLm5vZGV6W2ldLnBvaW50ZXJDKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYXJ0RGF0YS5saW5rcy5wdXNoKHsgc291cmNlOiB0aGlzLnByb3BzLm5vZGV6W2ldLmlkLCB0YXJnZXQ6IHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckMgfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMubm9kZXpbaV0ucG9pbnRlckQpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhcnREYXRhLmxpbmtzLnB1c2goeyBzb3VyY2U6IHRoaXMucHJvcHMubm9kZXpbaV0uaWQsIHRhcmdldDogdGhpcy5wcm9wcy5ub2RleltpXS5wb2ludGVyRCB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjaGFydERhdGEubm9kZXNbMF0ueCA9IHRoaXMuc3RhdGUud2luZG93V2lkdGggLyAyO1xuICAgICAgICBjaGFydERhdGEubm9kZXNbMF0ueSA9IHRoaXMuc3RhdGUud2luZG93SGVpZ2h0IC8gMjtcbiAgICAgICAgcmV0dXJuIGNoYXJ0RGF0YTtcbiAgICB9XG5cbiAgICByZXNpemVHcmFwaCgpe1xuICAgICAgICBsZXQgY3lTdHlsZSA9IHtcbiAgICAgICAgICAgIG1hcmdpbjogJ2F1dG8nLFxuICAgICAgICAgICAgYm9yZGVyOiAnMXB4IHNvbGlkIGxpZ2h0Z3JlZW4nXG4gICAgICAgIH07XG4gICAgICAgIGN5U3R5bGUubWF4SGVpZ2h0ID0gTWF0aC5tYXgodGhpcy5zdGF0ZS53aW5kb3dIZWlnaHQgKiAuNSwgNTAwKTtcbiAgICAgICAgY3lTdHlsZS5tYXhXaWR0aCA9IE1hdGgubWF4KHRoaXMuc3RhdGUud2luZG93V2lkdGggKiAuOCwgMzAwKTtcbiAgICAgICAgcmV0dXJuIGN5U3R5bGU7XG4gICAgfVxuXG4gICAgLy9pZiB5b3UgY2hhbmdlIHRoaXMgZnJvbSBhbiBhcnJvdyBmdW5jdGlvbiwgdGhpcy5zZXRTdGF0ZSBmYWlsc1xuICAgIGhhbmRsZVJlc2l6ZSA9ICgpID0+IHtcbiAgICAgICAgbGV0IHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICAgbGV0IHdpbmRvd1dpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgd2luZG93SGVpZ2h0LFxuICAgICAgICAgICAgd2luZG93V2lkdGhcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjb21wb25lbnREaWRNb3VudCgpe1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemUpO1xuICAgIH1cblxuICAgIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAgICB0aGlzLnBvcHVsYXRlR3JhcGgoKTtcbiAgICAgICB0aGlzLnJlc2l6ZUdyYXBoKCk7XG4gICAgfVxuXG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKXtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5oYW5kbGVSZXNpemUpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgbXlDb25maWcgPSB7XG4gICAgICAgICAgICBub2RlSGlnaGxpZ2h0QmVoYXZpb3I6IHRydWUsXG4gICAgICAgICAgICBkaXJlY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgIGF1dG9tYXRpY1JlYXJyYW5nZUFmdGVyRHJvcE5vZGU6IHRydWUsXG4gICAgICAgICAgICBkMzoge1xuICAgICAgICAgICAgICAgIGdyYXZpdHk6IC0zMDAsXG4gICAgICAgICAgICAgICAgbGlua0xlbmd0aDogMTIwLFxuICAgICAgICAgICAgICAgIGZvcmNlTWFueUJvZHk6IGZ1bmN0aW9uIHN0cmVuZ3RoKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTEwMDA7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtaW5ab29tOiAuNSxcbiAgICAgICAgICAgIG1heFpvb206IDEuNSxcbiAgICAgICAgICAgIGhlaWdodDogTWF0aC5tYXgodGhpcy5zdGF0ZS53aW5kb3dIZWlnaHQgKiAuNSwgNTAwKSxcbiAgICAgICAgICAgIHdpZHRoOiBNYXRoLm1heCh0aGlzLnN0YXRlLndpbmRvd1dpZHRoICogLjgsIDMwMCksXG4gICAgICAgICAgICAvL1RoZXJlIGFyZSBoZWlnaHQgYW5kIHdpZHRocyBhdmFpbGFibGUgaGVyZSwgYnV0IHRoZXkncmUgZm9yIHRoZSBncmFwaCBpdHNlbGYsIG5vdCB0aGUgY29udGFpbmVyIG9mIHRoZSBncmFwaFxuICAgICAgICAgICAgbm9kZToge1xuICAgICAgICAgICAgICAgIGZvbnRTaXplOiAxOCxcbiAgICAgICAgICAgICAgICBjb2xvcjogJ2xpZ2h0Z3JlZW4nLFxuICAgICAgICAgICAgICAgIHNpemU6IDgwMCxcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRTdHJva2VDb2xvcjogJ2JsdWUnLFxuICAgICAgICAgICAgICAgIGxhYmVsUHJvcGVydHk6ICd0aXRsZScsXG4gICAgICAgICAgICAgICAgaGlnaGxpZ2h0Rm9udFNpemU6ICdzYW1lJ1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IHtcbiAgICAgICAgICAgICAgICBoaWdobGlnaHRDb2xvcjogJ2xpZ2h0Ymx1ZScsXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2lkdGg6IDRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLm5vZGV6KSB7XG4gICAgICAgICAgICByZXR1cm4gPGRpdj5Mb2FkaW5nLi4uLjwvZGl2PlxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucHJvcHMucmVSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgIDxkaXYgc3R5bGU9e3RoaXMucmVzaXplR3JhcGgoKX0+IHsvKk1ha2UgdGhlIGN5U3R5bGUgaW50byBhIG1ldGhvZCBsaWtlIHBvcHVsYXRlR3JhcGggZm9yIENTUyBSRVNQT05TSVZFTkVTUyovfVxuICAgICAgICAgICAgICAgICAgICAgICAgPEdyYXBoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHM9e3RoaXMucHJvcHN9IFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiZ3JhcGgtaWRcIiAvLyBpZCBpcyBtYW5kYXRvcnksIGlmIG5vIGlkIGlzIGRlZmluZWQgcmQzZyB3aWxsIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YT17dGhpcy5wb3B1bGF0ZUdyYXBoKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnPXtteUNvbmZpZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrTm9kZT17dGhpcy5vbkNsaWNrTm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uUmlnaHRDbGlja05vZGU9e29uUmlnaHRDbGlja05vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbkNsaWNrR3JhcGg9e29uQ2xpY2tHcmFwaH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uQ2xpY2tMaW5rPXtvbkNsaWNrTGlua31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uUmlnaHRDbGlja0xpbms9e29uUmlnaHRDbGlja0xpbmt9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbk1vdXNlT3Zlck5vZGU9e29uTW91c2VPdmVyTm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uTW91c2VPdXROb2RlPXtvbk1vdXNlT3V0Tm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uTW91c2VPdmVyTGluaz17b25Nb3VzZU92ZXJMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25Nb3VzZU91dExpbms9e29uTW91c2VPdXRMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBzdHlsZT17dGhpcy5yZXNpemVHcmFwaCgpfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxHcmFwaFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzPXt0aGlzLnByb3BzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiZ3JhcGgtaWRcIiAvLyBpZCBpcyBtYW5kYXRvcnksIGlmIG5vIGlkIGlzIGRlZmluZWQgcmQzZyB3aWxsIHRocm93IGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YT17dGhpcy5wb3B1bGF0ZUdyYXBoKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlnPXtteUNvbmZpZ31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrTm9kZT17dGhpcy5vbkNsaWNrTm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uUmlnaHRDbGlja05vZGU9e29uUmlnaHRDbGlja05vZGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbkNsaWNrR3JhcGg9e29uQ2xpY2tHcmFwaH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uQ2xpY2tMaW5rPXtvbkNsaWNrTGlua31cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uUmlnaHRDbGlja0xpbms9e29uUmlnaHRDbGlja0xpbmt9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBvbk1vdXNlT3Zlck5vZGU9e29uTW91c2VPdmVyTm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uTW91c2VPdXROb2RlPXtvbk1vdXNlT3V0Tm9kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uTW91c2VPdmVyTGluaz17b25Nb3VzZU92ZXJMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25Nb3VzZU91dExpbms9e29uTW91c2VPdXRMaW5rfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSBzdGF0ZSA9PiAoe1xuICAgIG5vZGV6OiBzdGF0ZS5hZHZlbnR1cmUuY3VycmVudEFkdmVudHVyZS5ub2RlcyxcbiAgICBzaG93VXBkYXRlOiBzdGF0ZS5ub2RlLnNob3dVcGRhdGUsXG4gICAgY3VycmVudE5vZGU6IHN0YXRlLm5vZGUuY3VycmVudE5vZGUsXG4gICAgcmVSZW5kZXIgOiBzdGF0ZS5hZHZlbnR1cmUucmVSZW5kZXJcbn0pXG5cbi8vIGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShHcmFwaClcbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKShHcmFwaENvbnRhaW5lcik7Il19